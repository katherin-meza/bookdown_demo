<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Denouement | My Bookdown</title>
  <meta name="description" content="This is an example of using the bookdown package. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Denouement | My Bookdown" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is an example of using the bookdown package. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Denouement | My Bookdown" />
  
  <meta name="twitter:description" content="This is an example of using the bookdown package. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="YOUR NAME" />


<meta name="date" content="2023-03-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-munging.html"/>
<link rel="next" href="introduction.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="api-and-iterations.html"><a href="api-and-iterations.html"><i class="fa fa-check"></i><b>1</b> API and Iterations</a>
<ul>
<li class="chapter" data-level="1.0.1" data-path="api-and-iterations.html"><a href="api-and-iterations.html#lesson-objectives"><i class="fa fa-check"></i><b>1.0.1</b> Lesson Objectives</a></li>
<li class="chapter" data-level="1.1" data-path="api-and-iterations.html"><a href="api-and-iterations.html#apis"><i class="fa fa-check"></i><b>1.1</b> APIs</a></li>
<li class="chapter" data-level="1.2" data-path="api-and-iterations.html"><a href="api-and-iterations.html#nps-visitation-data"><i class="fa fa-check"></i><b>1.2</b> NPS Visitation Data</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="api-and-iterations.html"><a href="api-and-iterations.html#exercise-1"><i class="fa fa-check"></i><b>1.2.1</b> Exercise #1</a></li>
<li class="chapter" data-level="1.2.2" data-path="api-and-iterations.html"><a href="api-and-iterations.html#exercise-2"><i class="fa fa-check"></i><b>1.2.2</b> Exercise #2</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="api-and-iterations.html"><a href="api-and-iterations.html#functions"><i class="fa fa-check"></i><b>1.3</b> Functions</a></li>
<li class="chapter" data-level="1.4" data-path="api-and-iterations.html"><a href="api-and-iterations.html#functionize-api-pulls"><i class="fa fa-check"></i><b>1.4</b> Functionize API Pulls</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="api-and-iterations.html"><a href="api-and-iterations.html#exercise-3"><i class="fa fa-check"></i><b>1.4.1</b> Exercise #3</a></li>
<li class="chapter" data-level="1.4.2" data-path="api-and-iterations.html"><a href="api-and-iterations.html#exercise-4"><i class="fa fa-check"></i><b>1.4.2</b> Exercise #4</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="api-and-iterations.html"><a href="api-and-iterations.html#function-defaults"><i class="fa fa-check"></i><b>1.5</b> Function Defaults</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="api-and-iterations.html"><a href="api-and-iterations.html#exercise-5"><i class="fa fa-check"></i><b>1.5.1</b> Exercise #5</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="api-and-iterations.html"><a href="api-and-iterations.html#iterations"><i class="fa fa-check"></i><b>1.6</b> Iterations</a></li>
<li class="chapter" data-level="1.7" data-path="api-and-iterations.html"><a href="api-and-iterations.html#for-loops"><i class="fa fa-check"></i><b>1.7</b> For loops</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="api-and-iterations.html"><a href="api-and-iterations.html#exercise-6"><i class="fa fa-check"></i><b>1.7.1</b> Exercise #6</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="api-and-iterations.html"><a href="api-and-iterations.html#mapping"><i class="fa fa-check"></i><b>1.8</b> Mapping</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="api-and-iterations.html"><a href="api-and-iterations.html#exercise-7"><i class="fa fa-check"></i><b>1.8.1</b> Exercise #7</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-munging.html"><a href="data-munging.html"><i class="fa fa-check"></i><b>2</b> Data munging</a>
<ul>
<li class="chapter" data-level="2.0.1" data-path="data-munging.html"><a href="data-munging.html#lesson-objectives-1"><i class="fa fa-check"></i><b>2.0.1</b> Lesson Objectives</a></li>
<li class="chapter" data-level="2.1" data-path="data-munging.html"><a href="data-munging.html#pulling-in-necessary-packages-and-data-sets"><i class="fa fa-check"></i><b>2.1</b> Pulling in necessary packages and data sets</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="data-munging.html"><a href="data-munging.html#exercise-1-1"><i class="fa fa-check"></i><b>2.1.1</b> Exercise #1</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-munging.html"><a href="data-munging.html#exploring-our-data"><i class="fa fa-check"></i><b>2.2</b> Exploring our data</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data-munging.html"><a href="data-munging.html#exercise-2-1"><i class="fa fa-check"></i><b>2.2.1</b> Exercise #2</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-munging.html"><a href="data-munging.html#pivoting"><i class="fa fa-check"></i><b>2.3</b> Pivoting</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="data-munging.html"><a href="data-munging.html#exercise-3-1"><i class="fa fa-check"></i><b>2.3.1</b> Exercise #3</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-munging.html"><a href="data-munging.html#joining"><i class="fa fa-check"></i><b>2.4</b> Joining</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="data-munging.html"><a href="data-munging.html#exercise-4-1"><i class="fa fa-check"></i><b>2.4.1</b> Exercise #4</a></li>
<li class="chapter" data-level="2.4.2" data-path="data-munging.html"><a href="data-munging.html#exercise-5-1"><i class="fa fa-check"></i><b>2.4.2</b> Exercise #5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="denouement.html"><a href="denouement.html"><i class="fa fa-check"></i><b>3</b> Denouement</a>
<ul>
<li class="chapter" data-level="3.1" data-path="denouement.html"><a href="denouement.html#lesson-objectives-2"><i class="fa fa-check"></i><b>3.1</b> Lesson Objectives:</a></li>
<li class="chapter" data-level="3.2" data-path="denouement.html"><a href="denouement.html#streaflow-datasets"><i class="fa fa-check"></i><b>3.2</b> Streaflow Datasets</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="denouement.html"><a href="denouement.html#usgs-dataretrieval-r-package"><i class="fa fa-check"></i><b>3.2.1</b> USGS <code>dataRetrieval</code> R package</a></li>
<li class="chapter" data-level="3.2.2" data-path="denouement.html"><a href="denouement.html#cdwrs-api"><i class="fa fa-check"></i><b>3.2.2</b> CDWR’s API</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="denouement.html"><a href="denouement.html#exercise-1-2"><i class="fa fa-check"></i><b>3.3</b> Exercise #1</a></li>
<li class="chapter" data-level="3.4" data-path="denouement.html"><a href="denouement.html#exercise-2-2"><i class="fa fa-check"></i><b>3.4</b> Exercise #2</a></li>
<li class="chapter" data-level="3.5" data-path="denouement.html"><a href="denouement.html#exercise-3-2"><i class="fa fa-check"></i><b>3.5</b> Exercise #3</a></li>
<li class="chapter" data-level="3.6" data-path="denouement.html"><a href="denouement.html#exercise-4-2"><i class="fa fa-check"></i><b>3.6</b> Exercise #4</a></li>
<li class="chapter" data-level="3.7" data-path="denouement.html"><a href="denouement.html#exercise-5-2"><i class="fa fa-check"></i><b>3.7</b> Exercise #5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">My Bookdown</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="denouement" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Denouement<a href="denouement.html#denouement" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="lesson-objectives-2" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Lesson Objectives:<a href="denouement.html#lesson-objectives-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this lesson you will take all of the skills you have learned up to this point and use them on a completely new set of data. This lesson has <strong>five exercises</strong> that need to be completed.</p>
<div id="necessary-packages" class="section level4 hasAnchor" number="3.1.0.1">
<h4><span class="header-section-number">3.1.0.1</span> Necessary packages:<a href="denouement.html#necessary-packages" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="denouement.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb77-2"><a href="denouement.html#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb77-3"><a href="denouement.html#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb77-4"><a href="denouement.html#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb77-5"><a href="denouement.html#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb77-6"><a href="denouement.html#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dataRetrieval)</span>
<span id="cb77-7"><a href="denouement.html#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf) <span class="co"># for the map</span></span>
<span id="cb77-8"><a href="denouement.html#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mapview) <span class="co"># for making the interactive plot</span></span></code></pre></div>
</div>
</div>
<div id="streaflow-datasets" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Streaflow Datasets<a href="denouement.html#streaflow-datasets" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We are interested in looking at how the Cache la Poudre River’s flow changes as it travels out of the mountainous Poudre Canyon and through Fort Collins.</p>
<p>There are four stream flow monitoring sites on the Poudre that we are interested in: two managed by the US Geological Survey (USGS), and two managed by the Colorado Division of Water Resources (CDWR):</p>
<div id="usgs-dataretrieval-r-package" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> USGS <code>dataRetrieval</code> R package<a href="denouement.html#usgs-dataretrieval-r-package" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To pull data for USGS stream gages, we can use the <code>dataRetrieval</code> package, which is a USGS-managed set of functions that, much like our functions from Lesson 3.1, pull data from the USGS’s data warehouse using an API. Here we will pull flow data for our USGS stream gages of interest for the last two water years:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="denouement.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pulls USGS daily (&#39;dv&#39;) stream flow data:</span></span>
<span id="cb78-2"><a href="denouement.html#cb78-2" aria-hidden="true" tabindex="-1"></a>usgs <span class="ot">&lt;-</span> dataRetrieval<span class="sc">::</span><span class="fu">readNWISdv</span>(<span class="at">siteNumbers =</span> <span class="fu">c</span>(<span class="st">&quot;06752260&quot;</span>, <span class="st">&quot;06752280&quot;</span>), <span class="co"># USGS site code for the Poudre River at the Lincoln Bridge and the ELC</span></span>
<span id="cb78-3"><a href="denouement.html#cb78-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">parameterCd =</span> <span class="st">&quot;00060&quot;</span>, <span class="co"># USGS code for stream flow</span></span>
<span id="cb78-4"><a href="denouement.html#cb78-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">startDate =</span> <span class="st">&quot;2021-01-01&quot;</span>, <span class="co"># YYYY-MM-DD formatting</span></span>
<span id="cb78-5"><a href="denouement.html#cb78-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">endDate =</span> <span class="st">&quot;2022-12-31&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># YYYY-MM-DD formatting</span></span>
<span id="cb78-6"><a href="denouement.html#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">q_cfs =</span> X_00060_00003) <span class="sc">%&gt;%</span> <span class="co"># USGS code for stream flow units in cubic feet per second (CFS)</span></span>
<span id="cb78-7"><a href="denouement.html#cb78-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> lubridate<span class="sc">::</span><span class="fu">ymd</span>(Date), <span class="co"># convert the Date column to &quot;Date&quot; formatting using the `lubridate` package</span></span>
<span id="cb78-8"><a href="denouement.html#cb78-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Site =</span> <span class="fu">case_when</span>(site_no <span class="sc">==</span> <span class="st">&quot;06752260&quot;</span> <span class="sc">~</span> <span class="st">&quot;Lincoln&quot;</span>, </span>
<span id="cb78-9"><a href="denouement.html#cb78-9" aria-hidden="true" tabindex="-1"></a>                          site_no <span class="sc">==</span> <span class="st">&quot;06752280&quot;</span> <span class="sc">~</span> <span class="st">&quot;Boxelder&quot;</span>))</span></code></pre></div>
</div>
<div id="cdwrs-api" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> CDWR’s API<a href="denouement.html#cdwrs-api" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Alas, CDWR does NOT have an R package that pulls data from <a href="https://dwr.state.co.us/Rest/GET/Help#Datasets&amp;#SurfaceWaterController&amp;#gettingstarted&amp;#jsonxml">their API</a>, but they do have user-friendly directions on how to develop API calls.</p>
<p>Using the “URL generator” steps outlined for their <a href="https://dwr.state.co.us/Rest/GET/Help/SurfaceWaterTSDayGenerator">daily surface water time series data set</a>, we can get the last two water years of CFS data for the Poudre at the Canyon mouth (site abbreviation = CLAFTCCO) using the following URL:</p>
<p><a href="https://dwr.state.co.us/Rest/GET/api/v2/surfacewater/surfacewatertsday/?format=json&amp;dateFormat=dateOnly&amp;fields=abbrev%2CmeasDate%2Cvalue%2CmeasUnit&amp;encoding=deflate&amp;abbrev=CLAFTCCO&amp;min-measDate=10%2F01%2F2020&amp;max-measDate=09%2F30%2F2022" class="uri">https://dwr.state.co.us/Rest/GET/api/v2/surfacewater/surfacewatertsday/?format=json&amp;dateFormat=dateOnly&amp;fields=abbrev%2CmeasDate%2Cvalue%2CmeasUnit&amp;encoding=deflate&amp;abbrev=CLAFTCCO&amp;min-measDate=10%2F01%2F2020&amp;max-measDate=09%2F30%2F2022</a></p>
</div>
</div>
<div id="exercise-1-2" class="section level2 hasAnchor" number="3.3" style="color: maroon">
<h2><span class="header-section-number">3.3</span> Exercise #1<a href="denouement.html#exercise-1-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Using the URL above as the starting point, develop a function that creates a data frame of CDWR daily flow (CFS) data for a selected range of water years, for any site. (HINT: The final product of our API pull is a list with additional metadata about our API pull… how do we index a list to extract the time series flow data?)</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="denouement.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extracting data set</span></span>
<span id="cb79-2"><a href="denouement.html#cb79-2" aria-hidden="true" tabindex="-1"></a>start_date<span class="ot">&lt;-</span><span class="st">&quot;2021-01-01&quot;</span></span>
<span id="cb79-3"><a href="denouement.html#cb79-3" aria-hidden="true" tabindex="-1"></a>end_date<span class="ot">&lt;-</span><span class="st">&quot;2022-12-31&quot;</span></span>
<span id="cb79-4"><a href="denouement.html#cb79-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-5"><a href="denouement.html#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating the function </span></span>
<span id="cb79-6"><a href="denouement.html#cb79-6" aria-hidden="true" tabindex="-1"></a>co_water_data<span class="ot">&lt;-</span> <span class="cf">function</span>(abbrev, <span class="at">start_date=</span><span class="st">&quot;2021-01-01&quot;</span>, <span class="at">end_date=</span><span class="st">&quot;2022-12-31&quot;</span>){</span>
<span id="cb79-7"><a href="denouement.html#cb79-7" aria-hidden="true" tabindex="-1"></a>  test <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="at">url =</span> <span class="fu">paste0</span>(<span class="st">&quot;https://dwr.state.co.us/Rest/GET/api/v2/surfacewater/surfacewatertsday/?format=json&amp;dateFormat=dateOnly&amp;fields=abbrev%2CmeasDate%2Cvalue%2CmeasUnit&amp;encoding=deflate&amp;abbrev=&quot;</span>,abbrev,<span class="st">&quot;&amp;min-measDate=&quot;</span>, <span class="fu">substr</span>(start_date, <span class="dv">6</span>, <span class="dv">7</span>),<span class="st">&quot;%2F&quot;</span>, <span class="fu">substr</span>(start_date, <span class="dv">9</span>, <span class="dv">10</span>),<span class="st">&quot;%2F&quot;</span>, <span class="fu">substr</span>(start_date, <span class="dv">1</span>, <span class="dv">4</span>), <span class="st">&quot;&amp;max-measDate=&quot;</span>,<span class="fu">substr</span>(end_date, <span class="dv">6</span>,<span class="dv">7</span>),<span class="st">&quot;%2F&quot;</span>,<span class="fu">substr</span>(end_date, <span class="dv">9</span>,<span class="dv">10</span>),</span>
<span id="cb79-8"><a href="denouement.html#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;%2F&quot;</span>,<span class="fu">substr</span>(end_date, <span class="dv">1</span>, <span class="dv">4</span>)))</span>
<span id="cb79-9"><a href="denouement.html#cb79-9" aria-hidden="true" tabindex="-1"></a>text <span class="ot">&lt;-</span> <span class="fu">content</span>(test, <span class="at">as =</span> <span class="st">&quot;text&quot;</span>, <span class="at">enconding =</span> <span class="st">&quot;UTF-8&quot;</span>)</span>
<span id="cb79-10"><a href="denouement.html#cb79-10" aria-hidden="true" tabindex="-1"></a>final_data_water <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(text)[[<span class="dv">5</span>]]}</span>
<span id="cb79-11"><a href="denouement.html#cb79-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-12"><a href="denouement.html#cb79-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-13"><a href="denouement.html#cb79-13" aria-hidden="true" tabindex="-1"></a>test_set <span class="ot">&lt;-</span> <span class="fu">co_water_data</span>(<span class="at">abbrev =</span><span class="st">&quot;CLAFTCCO&quot;</span>, start_date , end_date )</span>
<span id="cb79-14"><a href="denouement.html#cb79-14" aria-hidden="true" tabindex="-1"></a>test_set</span>
<span id="cb79-15"><a href="denouement.html#cb79-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-16"><a href="denouement.html#cb79-16" aria-hidden="true" tabindex="-1"></a><span class="co">#how do we index a list to extract the time series flow data?</span></span>
<span id="cb79-17"><a href="denouement.html#cb79-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-18"><a href="denouement.html#cb79-18" aria-hidden="true" tabindex="-1"></a><span class="co">#It was done adding to the jsonlite line code double [[]] and within it write the number 5 winch correspond to the frame that we are interested in.</span></span></code></pre></div>
</div>
<div id="exercise-2-2" class="section level2 hasAnchor" number="3.4" style="color: maroon">
<h2><span class="header-section-number">3.4</span> Exercise #2<a href="denouement.html#exercise-2-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Map over the function you developed in Exercise #1 to pull flow data for CLAFTCCO and CLARIVCO for the 2021 and 2022 water years.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="denouement.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># My previous function was already coded to extract data from 2021 to 2022</span></span>
<span id="cb80-2"><a href="denouement.html#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="denouement.html#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Extracting &quot;CLAFTCCO&quot;, &quot;CLARIVCO&quot; parks from 2021 to 2022</span></span>
<span id="cb80-4"><a href="denouement.html#cb80-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-5"><a href="denouement.html#cb80-5" aria-hidden="true" tabindex="-1"></a>various_ids_water<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;CLAFTCCO&quot;</span>, <span class="st">&quot;CLARIVCO&quot;</span>)</span>
<span id="cb80-6"><a href="denouement.html#cb80-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-7"><a href="denouement.html#cb80-7" aria-hidden="true" tabindex="-1"></a>output_map_id_water <span class="ot">&lt;-</span> various_ids_water <span class="sc">%&gt;%</span> </span>
<span id="cb80-8"><a href="denouement.html#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span> <span class="fu">co_water_data</span>(<span class="at">abbrev =</span> . ))<span class="sc">%&gt;%</span></span>
<span id="cb80-9"><a href="denouement.html#cb80-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">bind_rows</span>()</span>
<span id="cb80-10"><a href="denouement.html#cb80-10" aria-hidden="true" tabindex="-1"></a>output_map_id_water</span>
<span id="cb80-11"><a href="denouement.html#cb80-11" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(output_map_id_water)</span></code></pre></div>
</div>
<div id="exercise-3-2" class="section level2 hasAnchor" number="3.5" style="color: maroon">
<h2><span class="header-section-number">3.5</span> Exercise #3<a href="denouement.html#exercise-3-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Join our USGS and CDWR data frames together (<code>bind_rows()</code>, perhaps?), then create an interactive ggplot of discharge (in CFS) through time displaying all four of our monitoring sites. Be sure all axes and labels are clear.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="denouement.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># startDate = &quot;2021-01-01&quot;, endDate = &quot;2022-12-31&quot; for Lincoln, and Boxelder stations </span></span>
<span id="cb81-2"><a href="denouement.html#cb81-2" aria-hidden="true" tabindex="-1"></a>data_one_usgs1 <span class="ot">&lt;-</span>usgs </span>
<span id="cb81-3"><a href="denouement.html#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="denouement.html#cb81-4" aria-hidden="true" tabindex="-1"></a>data_one_Lincoln_Boxelder<span class="ot">&lt;-</span> data_one_usgs1 <span class="sc">%&gt;%</span> </span>
<span id="cb81-5"><a href="denouement.html#cb81-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Site,Date,q_cfs )</span>
<span id="cb81-6"><a href="denouement.html#cb81-6" aria-hidden="true" tabindex="-1"></a>data_one_Lincoln_Boxelder</span>
<span id="cb81-7"><a href="denouement.html#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_one_Lincoln_Boxelder)</span>
<span id="cb81-8"><a href="denouement.html#cb81-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-9"><a href="denouement.html#cb81-9" aria-hidden="true" tabindex="-1"></a><span class="co">#startDate= &quot;2021-01-01&quot;, endDate = &quot;2022-12-31&quot; fro CLAFTCCO, and CLARIVCO station </span></span>
<span id="cb81-10"><a href="denouement.html#cb81-10" aria-hidden="true" tabindex="-1"></a>data_two_format<span class="ot">&lt;-</span>(output_map_id_water)</span>
<span id="cb81-11"><a href="denouement.html#cb81-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-12"><a href="denouement.html#cb81-12" aria-hidden="true" tabindex="-1"></a>data_two_CLAFTCCO_CLARIVCO<span class="ot">&lt;-</span>data_two_format <span class="sc">%&gt;%</span></span>
<span id="cb81-13"><a href="denouement.html#cb81-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(measDate,abbrev,value)<span class="sc">%&gt;%</span></span>
<span id="cb81-14"><a href="denouement.html#cb81-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(measDate),<span class="at">Site=</span>abbrev, <span class="at">q_cfs=</span>value)<span class="sc">%&gt;%</span></span>
<span id="cb81-15"><a href="denouement.html#cb81-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Site,Date,q_cfs)</span>
<span id="cb81-16"><a href="denouement.html#cb81-16" aria-hidden="true" tabindex="-1"></a>data_two_CLAFTCCO_CLARIVCO</span>
<span id="cb81-17"><a href="denouement.html#cb81-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-18"><a href="denouement.html#cb81-18" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_two_CLAFTCCO_CLARIVCO)</span>
<span id="cb81-19"><a href="denouement.html#cb81-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-20"><a href="denouement.html#cb81-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Join data two data sets</span></span>
<span id="cb81-21"><a href="denouement.html#cb81-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-22"><a href="denouement.html#cb81-22" aria-hidden="true" tabindex="-1"></a>joined_datasets<span class="ot">&lt;-</span><span class="fu">bind_rows</span>(data_two_CLAFTCCO_CLARIVCO,data_one_Lincoln_Boxelder)</span>
<span id="cb81-23"><a href="denouement.html#cb81-23" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(joined_datasets)</span>
<span id="cb81-24"><a href="denouement.html#cb81-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-25"><a href="denouement.html#cb81-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-26"><a href="denouement.html#cb81-26" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating an interactive ggplot</span></span>
<span id="cb81-27"><a href="denouement.html#cb81-27" aria-hidden="true" tabindex="-1"></a><span class="do">##Creating new equal format names</span></span>
<span id="cb81-28"><a href="denouement.html#cb81-28" aria-hidden="true" tabindex="-1"></a>mapping <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;CLAFTCCO&quot;</span> <span class="ot">=</span> <span class="st">&quot;CLAFTCCO&quot;</span>,</span>
<span id="cb81-29"><a href="denouement.html#cb81-29" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;CLARIVCO&quot;</span> <span class="ot">=</span> <span class="st">&quot;CLARIVCO&quot;</span>,</span>
<span id="cb81-30"><a href="denouement.html#cb81-30" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;Lincoln&quot;</span> <span class="ot">=</span> <span class="st">&quot;LINCOLN&quot;</span>,</span>
<span id="cb81-31"><a href="denouement.html#cb81-31" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;Boxelder&quot;</span> <span class="ot">=</span> <span class="st">&quot;BOXELDER&quot;</span>)</span>
<span id="cb81-32"><a href="denouement.html#cb81-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-33"><a href="denouement.html#cb81-33" aria-hidden="true" tabindex="-1"></a>re_name<span class="ot">&lt;-</span>joined_datasets<span class="sc">%&gt;%</span></span>
<span id="cb81-34"><a href="denouement.html#cb81-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sites =</span> <span class="fu">recode</span>(Site, <span class="sc">!!!</span>mapping))<span class="sc">%&gt;%</span></span>
<span id="cb81-35"><a href="denouement.html#cb81-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date,Sites,q_cfs)</span>
<span id="cb81-36"><a href="denouement.html#cb81-36" aria-hidden="true" tabindex="-1"></a>re_name</span>
<span id="cb81-37"><a href="denouement.html#cb81-37" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(re_name)</span>
<span id="cb81-38"><a href="denouement.html#cb81-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-39"><a href="denouement.html#cb81-39" aria-hidden="true" tabindex="-1"></a><span class="do">##Graphing</span></span>
<span id="cb81-40"><a href="denouement.html#cb81-40" aria-hidden="true" tabindex="-1"></a>interactive_map<span class="ot">&lt;-</span> plotly<span class="sc">::</span><span class="fu">ggplotly</span>(</span>
<span id="cb81-41"><a href="denouement.html#cb81-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data=</span>re_name) <span class="sc">+</span></span>
<span id="cb81-42"><a href="denouement.html#cb81-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Time &quot;</span>) <span class="sc">+</span> </span>
<span id="cb81-43"><a href="denouement.html#cb81-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Discarge (CSF)&quot;</span>)<span class="sc">+</span></span>
<span id="cb81-44"><a href="denouement.html#cb81-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> q_cfs, <span class="at">color=</span> Sites))<span class="sc">+</span></span>
<span id="cb81-45"><a href="denouement.html#cb81-45" aria-hidden="true" tabindex="-1"></a>                <span class="fu">theme_bw</span>(<span class="at">base_size=</span><span class="dv">10</span>)</span>
<span id="cb81-46"><a href="denouement.html#cb81-46" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-47"><a href="denouement.html#cb81-47" aria-hidden="true" tabindex="-1"></a>interactive_map</span></code></pre></div>
</div>
<div id="exercise-4-2" class="section level2 hasAnchor" number="3.6" style="color: maroon">
<h2><span class="header-section-number">3.6</span> Exercise #4<a href="denouement.html#exercise-4-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Create an interactive plot of the daily difference in discharge between the Cache la Poudre River at the canyon mouth and each of the sites downstream. Make sure your plot axes are clear.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="denouement.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Converting to wide data frame</span></span>
<span id="cb82-2"><a href="denouement.html#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(re_name)</span>
<span id="cb82-3"><a href="denouement.html#cb82-3" aria-hidden="true" tabindex="-1"></a>Stations<span class="ot">&lt;-</span><span class="fu">c</span>( <span class="st">&quot;CLARIVCO&quot;</span>, <span class="st">&quot;LINCOLN&quot;</span>,<span class="st">&quot;BOXELDER&quot;</span>)</span>
<span id="cb82-4"><a href="denouement.html#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="denouement.html#cb82-5" aria-hidden="true" tabindex="-1"></a>wide_data_stations <span class="ot">&lt;-</span> re_name <span class="sc">%&gt;%</span></span>
<span id="cb82-6"><a href="denouement.html#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, Sites, q_cfs) <span class="sc">%&gt;%</span></span>
<span id="cb82-7"><a href="denouement.html#cb82-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(., <span class="at">names_from =</span> Sites, <span class="at">values_from =</span> q_cfs)</span>
<span id="cb82-8"><a href="denouement.html#cb82-8" aria-hidden="true" tabindex="-1"></a>wide_data_stations </span>
<span id="cb82-9"><a href="denouement.html#cb82-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-10"><a href="denouement.html#cb82-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-11"><a href="denouement.html#cb82-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculating the differences</span></span>
<span id="cb82-12"><a href="denouement.html#cb82-12" aria-hidden="true" tabindex="-1"></a>unit_differences_stations<span class="ot">&lt;-</span> wide_data_stations <span class="sc">%&gt;%</span></span>
<span id="cb82-13"><a href="denouement.html#cb82-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Date) <span class="sc">%&gt;%</span></span>
<span id="cb82-14"><a href="denouement.html#cb82-14" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate_at</span>(<span class="at">.vars=</span> Stations, <span class="at">.funs =</span> <span class="sc">~</span>(CLAFTCCO<span class="sc">-</span> .))<span class="sc">%&gt;%</span></span>
<span id="cb82-15"><a href="denouement.html#cb82-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">differences_CLAFTCCO_CLARIVCO=</span>CLARIVCO,<span class="at">differences_CLAFTCCO_LINCOLN=</span> LINCOLN,<span class="at">differences_CLAFTCCO_BOXELDER=</span>BOXELDER)<span class="sc">%&gt;%</span></span>
<span id="cb82-16"><a href="denouement.html#cb82-16" aria-hidden="true" tabindex="-1"></a> <span class="fu">select</span>(<span class="sc">-</span>CLAFTCCO)</span>
<span id="cb82-17"><a href="denouement.html#cb82-17" aria-hidden="true" tabindex="-1"></a>unit_differences_stations</span>
<span id="cb82-18"><a href="denouement.html#cb82-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-19"><a href="denouement.html#cb82-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-20"><a href="denouement.html#cb82-20" aria-hidden="true" tabindex="-1"></a>longer_unit_stations<span class="ot">&lt;-</span> unit_differences_stations<span class="sc">%&gt;%</span></span>
<span id="cb82-21"><a href="denouement.html#cb82-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Date,</span>
<span id="cb82-22"><a href="denouement.html#cb82-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;Stations&quot;</span>,</span>
<span id="cb82-23"><a href="denouement.html#cb82-23" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;q_cfs&quot;</span>)</span>
<span id="cb82-24"><a href="denouement.html#cb82-24" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb82-25"><a href="denouement.html#cb82-25" aria-hidden="true" tabindex="-1"></a>longer_unit_stations      </span>
<span id="cb82-26"><a href="denouement.html#cb82-26" aria-hidden="true" tabindex="-1"></a><span class="co">#Graphing the differences</span></span>
<span id="cb82-27"><a href="denouement.html#cb82-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-28"><a href="denouement.html#cb82-28" aria-hidden="true" tabindex="-1"></a>interactive_map_differences_stations<span class="ot">&lt;-</span> plotly<span class="sc">::</span><span class="fu">ggplotly</span>(</span>
<span id="cb82-29"><a href="denouement.html#cb82-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data=</span>longer_unit_stations) <span class="sc">+</span></span>
<span id="cb82-30"><a href="denouement.html#cb82-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Time &quot;</span>) <span class="sc">+</span> </span>
<span id="cb82-31"><a href="denouement.html#cb82-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Discarge (CSF)&quot;</span>)<span class="sc">+</span></span>
<span id="cb82-32"><a href="denouement.html#cb82-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> q_cfs, <span class="at">color=</span> Stations))<span class="sc">+</span></span>
<span id="cb82-33"><a href="denouement.html#cb82-33" aria-hidden="true" tabindex="-1"></a>                <span class="fu">theme_bw</span>(<span class="at">base_size=</span><span class="dv">10</span>)</span>
<span id="cb82-34"><a href="denouement.html#cb82-34" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb82-35"><a href="denouement.html#cb82-35" aria-hidden="true" tabindex="-1"></a>interactive_map_differences_stations</span></code></pre></div>
</div>
<div id="exercise-5-2" class="section level2 hasAnchor" number="3.7" style="color: maroon">
<h2><span class="header-section-number">3.7</span> Exercise #5<a href="denouement.html#exercise-5-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For each of our downstream locations, calculate how many days the canyon mouth had LOWER flow. Is this what you expected? Why or why not?</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="denouement.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Based on the discarge differences betweee Claftco - .var</span></span>
<span id="cb83-2"><a href="denouement.html#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(unit_differences_stations)</span>
<span id="cb83-3"><a href="denouement.html#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="denouement.html#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Tranforming from wide to pivot data</span></span>
<span id="cb83-5"><a href="denouement.html#cb83-5" aria-hidden="true" tabindex="-1"></a>unit_stations_longer<span class="ot">&lt;-</span> unit_differences_stations<span class="sc">%&gt;%</span></span>
<span id="cb83-6"><a href="denouement.html#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Date,</span>
<span id="cb83-7"><a href="denouement.html#cb83-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;Stations&quot;</span>,</span>
<span id="cb83-8"><a href="denouement.html#cb83-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;q_cfs&quot;</span>)</span>
<span id="cb83-9"><a href="denouement.html#cb83-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(unit_stations_longer)</span>
<span id="cb83-10"><a href="denouement.html#cb83-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-11"><a href="denouement.html#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Grouping by Stations</span></span>
<span id="cb83-12"><a href="denouement.html#cb83-12" aria-hidden="true" tabindex="-1"></a>Grouping_statitons<span class="ot">&lt;-</span>unit_stations_longer<span class="sc">%&gt;%</span></span>
<span id="cb83-13"><a href="denouement.html#cb83-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Date,Stations)<span class="sc">%&gt;%</span></span>
<span id="cb83-14"><a href="denouement.html#cb83-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(q_cfs<span class="sc">&lt;</span> <span class="dv">0</span>)<span class="sc">%&gt;%</span></span>
<span id="cb83-15"><a href="denouement.html#cb83-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(q_cfs,<span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb83-16"><a href="denouement.html#cb83-16" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Grouping_statitons)</span>
<span id="cb83-17"><a href="denouement.html#cb83-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-18"><a href="denouement.html#cb83-18" aria-hidden="true" tabindex="-1"></a>total_negative_station<span class="ot">&lt;-</span>Grouping_statitons<span class="sc">%&gt;%</span></span>
<span id="cb83-19"><a href="denouement.html#cb83-19" aria-hidden="true" tabindex="-1"></a> <span class="fu">group_by</span>(Stations)<span class="sc">%&gt;%</span></span>
<span id="cb83-20"><a href="denouement.html#cb83-20" aria-hidden="true" tabindex="-1"></a> <span class="fu">summarize</span>(<span class="at">total_negative =</span> <span class="fu">sum</span>(n))</span>
<span id="cb83-21"><a href="denouement.html#cb83-21" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(total_negative_station)</span>
<span id="cb83-22"><a href="denouement.html#cb83-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-23"><a href="denouement.html#cb83-23" aria-hidden="true" tabindex="-1"></a><span class="co">#Lincoln had 58 days with more discharge than the the canyon mouth. This result matches my expectation because on the downstream a significant amount of water is being using for agriculture. </span></span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-munging.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="introduction.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
